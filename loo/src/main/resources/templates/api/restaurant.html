<!DOCTYPE html>
<html>
<head th:replace="head :: head"></head>
<head>
	<title>맛집</title>
	<script src="https://code.jquery.com/jquery-3.4.1.js"></script>
	<script type="text/javascript">
		$(document).ready(function () {
			$.ajax({
				url: "https://apis.data.go.kr/6260000/FoodService/getFoodKr?serviceKey=kL00C7wEpGgpo2n%2FErweSgWemnixWZxI2N%2BTzlkyWrugWrGVQTQGO0lpetrDfzp88yDNXbcJJDyN2mTGdowblw%3D%3D&pageNo=1&numOfRows=10&resultType=json",           //파일 경로, 어떤 파일을 불러올 것인지               //캐시 사용여부 true false
				dataType: "json",             //타입
				success: function (data) {
					console.log(data)
					let matgip_data = data['getFoodKr']['item']
					for (let i = 0; i < matgip_data.length; i++) {
						put_data1(i, matgip_data[i]['MAIN_TITLE'], matgip_data[i]['ITEMCNTNTS'], matgip_data[i]['ADDR1'], matgip_data[i]['CNTCT_TEL'], matgip_data[i]['MAIN_IMG_THUMB'])
					}
					console.log(matgip_data)
				},
				error: function () {  //불러오지 못했을때 할일
					alert('Error loading XML document');
				}
			})
	
		})
	
		function put_data1(num, title, contents, add, tel, img) {
			let html = `
						<div class="col-12 col-md-6">
						<div class="card">
							<img class="card-img-top" src="${img}" alt="Unsplash">
							<div class="card-header">
								<h5 class="card-title mb-0">${num + 1}.${title}</h5>
							</div>
							<div class="card-body">
								<p class="card-text">${contents}</p>
								<a href="tel:${tel}" class="card-link">${tel}</a>
								<a href="#" class="card-link">${add}</a>
							</div>
						</div>
					</div>
						`
			$('#matgip').append(html);
		}
	
	</script>
	
	<script type="text/javascript">
		$(document).ready(function () {
			$("#more").click(function () {
				$.ajax({
					url: "https://apis.data.go.kr/6260000/FoodService/getFoodKr?serviceKey=kL00C7wEpGgpo2n%2FErweSgWemnixWZxI2N%2BTzlkyWrugWrGVQTQGO0lpetrDfzp88yDNXbcJJDyN2mTGdowblw%3D%3D&pageNo=2&numOfRows=10&resultType=json",           //파일 경로, 어떤 파일을 불러올 것인지               //캐시 사용여부 true false
					dataType: "json",             //타입
					success: function (data) {
						console.log(data)
						let matgip_data = data['getFoodKr']['item']
						for (let i = 0; i < matgip_data.length; i++) {
							put_data(i, matgip_data[i]['MAIN_TITLE'], matgip_data[i]['ITEMCNTNTS'], matgip_data[i]['ADDR1'], matgip_data[i]['CNTCT_TEL'], matgip_data[i]['MAIN_IMG_THUMB'])
						}
						console.log(matgip_data)
	
					},
					error: function () {  //불러오지 못했을때 할일
						alert('Error loading XML document');
					}
	
				})
			})
		})
		function put_data(num, title, contents, add, tel, img) {
			let html = `
						<div class="col-12 col-md-6">
						<div class="card">
							<img class="card-img-top" src="${img}" alt="Unsplash">
							<div class="card-header">
								<h5 class="card-title mb-0">${num}.${title}</h5>
							</div>
							<div class="card-body">
								<p class="card-text">${contents}</p>
								<a href="tel:${tel}" class="card-link">${tel}</a>
								<a href="#" class="card-link">${add}</a>
							</div>
						</div>
					</div>
						`
			
			$("#matgip").map(function(){
				return this.firstChild;
			}).before(html)
		}
	
	</script>
</head>

<body>
	<div class="wrapper">
		<!-- 사이드 메뉴 -->
		<!-- 로그아웃 시 -->
		<nav id="sidebar" class="sidebar js-sidebar" th:unless="${session.loginMember}">
			<div th:replace="sidebar :: logout"></div>
		</nav>
		<!-- 로그인 시 -->
		<nav id="sidebar" class="sidebar js-sidebar" th:if="${session.loginMember}">
			<div th:replace="sidebar :: login"></div>
		</nav>

		<div class="main">
		<!-- 로그아웃 시 드롭다운 -->
			<nav class="navbar navbar-expand navbar-light navbar-bg" th:unless="${session.loginMember}">
				<a class="sidebar-toggle js-sidebar-toggle">
					<i class="hamburger align-self-center"></i>
    			</a>
				<div th:replace="dropdown :: logout"></div>
			</nav>
		<!-- 로그인 시 드롭다운 -->
			<nav class="navbar navbar-expand navbar-light navbar-bg" th:if="${session.loginMember}">
				<a class="sidebar-toggle js-sidebar-toggle">
					<i class="hamburger align-self-center"></i>
    			</a>
				<div th:replace="dropdown :: login"></div>
			</nav>

			<main class="content">
				<div class="container-fluid p-0">
					<div class="mb-3">
						<h1 class="h3 d-inline align-middle">맛집</h1>
						<a class="badge bg-dark text-white ms-2" id="more">
							오늘의 맛집 추천이 맘에 들지 않는다면?
						</a>
					</div>

					<div class="row" id="matgip">

					</div>
				</div>
			</main>

		</div>
	</div>

	<script src="/js/app.js"></script>

</body>

</html>